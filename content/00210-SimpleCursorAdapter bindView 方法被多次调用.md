# SimpleCursorAdapter bindView 方法被多次调用
- 2013-03-22 06:21:25
- 
- android,java,cursor,adapter,

<div>现象：实现了一个SimpleCursorAdapter , 其中bindView()方法被多次调用，通过日志发现，被调用的位置是0。</div><div>大概的思路是，上层父容器一直在询问这个gridview需要多少空间，所以gridview一直在计算它的高度，所以会导致bindView方法多次被调用。</div><div><br /></div><div>Gridview&nbsp;</div><div><br /></div><div>onMeasure(int widthMeasureSpec, int heightMeasureSpec)</div><div><br /></div><div>mItemCount = mAdapter == null ? 0 : mAdapter.getCount();</div><div>final int count = mItemCount;</div><div>if (count &gt; 0)</div><div>final View child = obtainView(0, mIsScrap);</div><div><br /></div><div>AbsListView</div><div><br /></div><div>View obtainView(int position, boolean[] isScrap)</div><div><br /></div><div>scrapView = mRecycler.getScrapView(position);</div><div>View child;</div><div>if (scrapView != null) {</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>child = mAdapter.getView(position, scrapView, this);</div><div>}else{</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>child = mAdapter.getView(position, null, this);</div><div>}</div><div><br /></div><div>CursorAdapter</div><div><br /></div><div><span class="Apple-tab-span" style="white-space:pre">	</span>public View getView(int position, View convertView, ViewGroup parent) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (!mDataValid) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalStateException("this should only be called when the cursor is valid");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (!mCursor.moveToPosition(position)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new IllegalStateException("couldn't move cursor to position " + position);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; View v;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (convertView == null) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v = newView(mContext, mCursor, parent);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v = convertView;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; bindView(v, mContext, mCursor);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; return v;</div><div>&nbsp; &nbsp; }</div><div><br /></div><div>到现在为止，没有找到办法。应该是需要从上层的父容器入手。或者另外一个解决办法是自定义一个gridview之类的。</div><div><br /></div><div><br /></div><div>====================</div><div><br /></div><div>对于这个问题，我的同事是这样答复我的。</div><div><pre wrap="">this is out of our control. The android renders a view at least 3 times 
before it gets displayed.
The first two have something to do with measurement. For the grid view, 
they assume all the views
are the same size (the size of the view number 0) and then display the 
rest.  so bind view may be called
20 or 30 times per redraw.  We should make it as simple as possible.</pre></div>