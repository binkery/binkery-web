# 一个 data class 不可空类型为null的惨案
- Kotlin,data class,
- 2020.08.16

data class 算是 kotlin 的一大特性，很多人对他非常喜欢。在设计 Kotlin 的时候，充分借鉴了 Java 语言中在写 JavaBean 中非常繁琐的特点，特意设计了 data class 这样的类型，用来定义数据类。

用 data class 定义的数据类，kotlin 会在编译的时候，自动帮我们生成了很多相应的方法：

 - equals() / hashCode()
 - toString()
 - componentN() 
 - copy() 

一般我们的写法如下：

	data class User(var userId:Int,var name:String)
	var user = User(0,"binkery")

我们在项目中，data class 用来定义网络接口返回的响应数据体，但是在实际开发中，我们发现，data class 并不会生成无参的构造器，以至于我们有时候需要实例化对象的时候，需要传很多参数，非常麻烦。

为了解决这个问题，我们通过给每个成员赋初始值的方式，让 data class 生成无参的构造器。代码如下：

	data class User(var userId : Int = 0,var name :String = "")
	var user = User()

但是后来，我们又发现一个问题，当用 Gson 去解析 Json 的时候，如果 Json 没有对应的字段，这个时候，我们可能得到一个 null 的值。比如我们用 User 去解析 "{}" 的时候，会发现得到的是一个 User 对象，但是 userId 和 name 都是 null ，而我们定义的 userId 和 name 都是不可空类型。 

这并不是我们所想要的，因为服务端总有可能没有给某个字段赋值，这样客户端解析的时候，就会变成 null ，而在开发时，我们并不认为它会是 null 。